<html>
  <head>
    <title>Demo dataset</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                padding: 2em;
            }
            table {
                border-collapse: collapse;
                width: 100%;
                margin-top: 1.5em;
                border: 2px solid #444;
            }
            th,
            td {
                border: 1px solid #444;
                padding: 8px;
                text-align: left;
                vertical-align: top;
            }
            th {
                background: #eaeaea;
            }
            tbody tr:nth-child(odd) {
                background: #fff;
            }
            tbody tr:nth-child(even) {
                background: #f0f8ff;
            }
            td ul {
                margin: 0;
                padding-left: 24px;
            }
            .json-sub-table {
                margin: 8px 0;
            }
            td a {
                color: #1565c0;
            }
        </style>
    <script type="application/ld+json">    
    </script>
  </head>
  <body>
    <div id="dataset-table">Loading...</div>
        <script>
            // Detect URLs in strings
            function linkify(str) {
                if (typeof str === "string" && str.match(/^(https?:\/\/[^\s]+)$/)) {
                    return `<a href="${str}" target="_blank" rel="noopener">${str}</a>`;
                }
                return str;
            }

            // Recursively create table for the data
            function renderValue(val) {
                if (typeof val === "string" || typeof val === "number" || typeof val === "boolean") {
                    return linkify(String(val));
                } else if (Array.isArray(val)) {
                    if (val.length === 0) return '<i>(empty)</i>';
                    if (val.every(e => ["string", "number", "boolean"].includes(typeof e))) {
                        return "<ul>" + val.map(e => `<li>${linkify(e)}</li>`).join("") + "</ul>";
                    }
                    else if (val.every(e => typeof e === "object" && e !== null)) {
                        const allKeys = Array.from(new Set(val.flatMap(obj => Object.keys(obj))));
                        let subTable = `<table class="json-sub-table"><thead><tr>${allKeys.map(k => `<th>${k}</th>`).join('')
                            }</tr></thead><tbody>`;
                        val.forEach(obj => {
                            subTable += '<tr>' +
                                allKeys.map(k => `<td>${renderValue(obj[k]) ?? ""}</td>`).join('') +
                                '</tr>';
                        });
                        subTable += "</tbody></table>";
                        return subTable;
                    }
                    return `<pre>${JSON.stringify(val, null, 2)}</pre>`;
                } else if (typeof val === "object" && val !== null) {
                    let subTable = `<table class="json-sub-table"><tbody>`;
                    for (const [k, v] of Object.entries(val)) {
                        subTable += `<tr><td><b>${k}</b></td><td>${renderValue(v)}</td></tr>`;
                    }
                    subTable += "</tbody></table>";
                    return subTable;
                } else {
                    return '';
                }
            }
            // Fetch and render the JSON-LD data from the local file
            fetch('data.jsonld')
                .then(response => response.json())
                .then(data => {
                    let html = '<table>';
                    html += '<thead><tr><th>Key</th><th>Value</th></tr></thead><tbody>';
                    Object.entries(data).forEach(([key, val]) => {
                        html += `<tr><td>${key}</td><td>${renderValue(val)}</td></tr>`;
                    });
                    html += '</tbody></table>';
                    document.getElementById('dataset-table').innerHTML = html;
                })
                .catch(err => {
                    document.getElementById('dataset-table').textContent = 'Failed to load data!';
                    console.error(err);
                });
            </script>
  </body>
</html>